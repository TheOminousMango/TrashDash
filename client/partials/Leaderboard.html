<template name="Leaderboard">
	<style>
	#scrollable-content {
	  height: 180px;
	  overflow: auto;
	  border: 1px black solid;
	}

	#footer {
	  height: 20px;
	  border: 1px black solid;
	  background-color: rgb(180, 180, 180);
	}
	
	.grey-background {
		background-color: rgb(200, 200, 200);
	}
	</style>
	
	<div id="scrollable-content" class="grey-background">
		
	</div>
	{{#if is_player}}
		<div id="footer"></div>
	{{/if}}
	
	<script>
	
		var sort_by = function(field, reverse, primer){
		   var key = primer ? 
			   function(x) {return primer(x[field])} : 
			   function(x) {return x[field]};

		   reverse = !reverse ? 1 : -1;

		   return function (a, b) {
			   return a = key(a), b = key(b), reverse * ((a > b) - (b > a));
			 } 
		}
		
		function updateBoard() {
			var p = 0;
			$( "#scrollable-content" ).html("");
			var users = Meteor.users.find().fetch().sort(sort_by('points', true, parseInt));
			for(var i = 0; i < Meteor.users.find().fetch().length; i++) {
				var user = users[i];
				if(user.role == "player") {
					p += 1;
					$( "#scrollable-content" ).append( "<p>" +  p + ": " + user.emails[0].address + "	(" + user.points + ")" + "</p>" );
					if(user._id == Meteor.user()._id) {
						$( "#footer" ).html((p) + ": " + Meteor.user().emails[0].address + " (" + Meteor.user().points + ")");
					}
				}
			}
		}
		
		setInterval(updateBoard, 1000);
	</script>

</template>